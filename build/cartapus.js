var e=require("tiny-emitter");function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function r(e,t){return r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},r(e,t)}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function s(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var s=0;return function(){return s>=e.length?{done:!0}:{done:!1,value:e[s++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}module.exports=/*#__PURE__*/function(e){var t,n;function o(t){var r;return void 0===t&&(t={}),(r=e.call(this)||this).intersect=r.intersect.bind(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(r)),r.options=Object.assign({root:null,rootMargin:"0px",threshold:0,once:!1,events:!0},t),r.createMainObserver(),r.init(),r}n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,r(t,n);var i=o.prototype;return i.createMainObserver=function(){this.observers=[{observer:new IntersectionObserver(this.intersect,this.options),threshold:this.options.threshold,elements:[]}]},i.init=function(){this.getElems(),this.createObservers(),this.observe()},i.getElems=function(){var e=null===this.options.root?document:this.options.root;this.elems=e.querySelectorAll("[data-cartapus]")},i.createObservers=function(){for(var e,t=s(this.elems);!(e=t()).done;){var r=e.value;if(r.dataset.cartapusThreshold){for(var n,o=parseFloat(r.dataset.cartapusThreshold),i=!1,a=s(this.observers);!(n=a()).done;){var c=n.value;o===c.threshold&&(i=!0,c.elements.push(r))}if(!i){var u={observer:new IntersectionObserver(this.intersect,Object.assign(this.options,{threshold:o})),threshold:o,elements:[r]};this.observers.push(u)}}else this.observers[0].elements.push(r)}},i.intersect=function(e,t){var r=this;e.forEach(function(e){e.isIntersecting?(e.target.dataset.cartapus="visible",r.options.once&&"false"!==e.target.dataset.cartapusOnce&&t.unobserve(e.target)):e.target.dataset.cartapus="hidden",r.options.events&&r.dispatch(e)})},i.dispatch=function(e){var t={element:e.target,visible:e.isIntersecting,intersection:e},r=new CustomEvent("cartapusintersect",{detail:t});e.target.dispatchEvent(r),this.emit("intersect",t)},i.observe=function(){this.observers.forEach(function(e){e.elements.forEach(function(t){e.observer.observe(t)})})},i.unobserve=function(){this.observers.forEach(function(e){e.elements.forEach(function(t){e.observer.unobserve(t)})})},i.destroy=function(){this.unobserve(),this.observers.forEach(function(e){e.elements=[]})},i.reset=function(){this.destroy(),this.init()},o}(/*#__PURE__*/t(e).default);
//# sourceMappingURL=cartapus.js.map
